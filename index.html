<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>UGC Hub - Login</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
    import { 
      getAuth, 
      GoogleAuthProvider, 
      signInWithPopup, 
      setPersistence, 
      browserLocalPersistence,
      onAuthStateChanged,
      signOut
    } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";

    // 🔑 Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyDOwV2NUiktr-JY8VewTD1tBvsah2q2T6s",
      authDomain: "forefront-ugc-subscriptions.firebaseapp.com",
      projectId: "forefront-ugc-subscriptions",
      storageBucket: "forefront-ugc-subscriptions.firebasestorage.app",
      messagingSenderId: "988222732912",
      appId: "1:988222732912:web:151a0b709106dfc67692b5",
      measurementId: "G-ZXHZ4T2VKS"
    };

    // 🔧 Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const provider = new GoogleAuthProvider();

    // 🚀 Login function
    async function loginWithGoogle() {
      try {
        await setPersistence(auth, browserLocalPersistence); // persist session
        const result = await signInWithPopup(auth, provider);
        console.log("✅ Signed in:", result.user);
        window.location.href = "./tier1.html"; // redirect after login
      } catch (err) {
        console.error("Login error:", err);
        alert("Login failed. Check console for details.");
      }
    }

    // 🚪 Logout
    async function logout() {
      try {
        await signOut(auth);
        console.log("Logged out");
        document.getElementById("user-info").classList.add("hidden");
        document.getElementById("login-section").classList.remove("hidden");
      } catch (err) {
        console.error("Logout error:", err);
      }
    }

    // 🔍 Check auth state
    onAuthStateChanged(auth, (user) => {
      if (user) {
        console.log("Auth state: logged in", user);
        document.getElementById("login-section").classList.add("hidden");
        document.getElementById("user-info").classList.remove("hidden");
        document.getElementById("user-email").textContent = user.email;
      } else {
        console.log("Auth state: not logged in");
        document.getElementById("login-section").classList.remove("hidden");
        document.getElementById("user-info").classList.add("hidden");
      }
    });

    // Bind buttons
    window.loginWithGoogle = loginWithGoogle;
    window.logout = logout;
  </script>
</head>
<body class="bg-gray-900 text-gray-200 font-inter">
  <div class="min-h-screen flex items-center justify-center px-6 py-12">
    <div class="bg-gray-800 p-10 rounded-2xl shadow-xl w-full max-w-md space-y-6 border border-gray-700">

      <!-- Login Section -->
      <div id="login-section" class="space-y-6">
        <h1 class="text-3xl font-bold text-center text-yellow-500">UGC Hub</h1>
        <p class="text-center text-gray-400">Sign in to access your premium dashboard</p>
        <button 
          onclick="loginWithGoogle()" 
          class="w-full py-3 px-6 rounded-xl bg-yellow-500 text-gray-900 font-semibold hover:bg-yellow-600 transition">
          Sign in with Google
        </button>
      </div>

      <!-- User Info Section -->
      <div id="user-info" class="hidden space-y-4 text-center">
        <p class="text-lg">Logged in as <span id="user-email" class="font-semibold"></span></p>
        <div class="flex justify-center gap-4">
          <a href="./tier1.html" 
             class="py-2 px-4 rounded-lg bg-green-500 text-gray-900 font-semibold hover:bg-green-600 transition">
            Go to Dashboard
          </a>
          <button onclick="logout()" 
            class="py-2 px-4 rounded-lg bg-red-500 text-gray-900 font-semibold hover:bg-red-600 transition">
            Log Out
          </button>
        </div>
      </div>

    </div>
  </div>
</body>
</html>

